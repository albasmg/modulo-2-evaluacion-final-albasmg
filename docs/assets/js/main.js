"use strict";const searchButton=document.querySelector(".js-searchButton"),resultsContainer=document.querySelector(".js-resultsContainer");let favoriteSeries=JSON.parse(localStorage.getItem("series"))||[],originalSeries=[];const removeLastSearch=()=>resultsContainer.innerHTML="",addSeriesListeners=()=>{const e=document.querySelectorAll(".series__container");for(const t of e)t.addEventListener("click",handleAddToFavoritesClick)},findSerieInFavorites=e=>favoriteSeries.find(t=>e===t.id),handleAddToFavoritesClick=e=>{const t=e.currentTarget.querySelector("img").src,r=e.currentTarget.querySelector(".series__name").innerHTML,s=parseInt(e.currentTarget.id),i={id:s,name:r,image:t},a=findSerieInFavorites(s);console.log(r),a||(e.currentTarget.classList.toggle("selected"),favoriteSeries.push(i),localStorage.setItem("series",JSON.stringify(favoriteSeries)),printFavorites())},printFavorites=e=>{const t=e||favoriteSeries[favoriteSeries.length-1],r=document.querySelector(".js-favoritesContainer"),s=document.createElement("div"),i=document.createElement("button"),a=document.createElement("img"),n=document.createElement("p"),o=document.createTextNode(t.name),c=document.createElement("i");r.appendChild(s),s.appendChild(i),s.appendChild(a),s.appendChild(n),n.appendChild(o),i.appendChild(c),a.setAttribute("src",t.image?t.image:"https://via.placeholder.com/210x295/ffffff/666666/? text=TV"),i.setAttribute("class","far fa-trash-alt"),s.classList.add("favorites__container"),a.classList.add("favorites__image"),n.classList.add("favorites__name"),i.classList.add("favorites__removeButton");i.addEventListener("click",()=>{const e=favoriteSeries.filter(e=>e.id!==t.id);localStorage.setItem("series",JSON.stringify(e)),r.innerHTML="",favoriteSeries=e,removeLastSearch(),printResults(originalSeries);for(const t of e)printFavorites(t)})},printResults=e=>{removeLastSearch();for(const t of e){const e=t.show.id,r=t.show.name,s=t.show.image,i=document.createElement("li"),a=document.createElement("img"),n=document.createElement("p"),o=document.createTextNode(r);resultsContainer.appendChild(i),i.appendChild(a),i.appendChild(n),n.appendChild(o),i.setAttribute("id",e),a.setAttribute("src",s?s.medium:"https://via.placeholder.com/210x295/ffffff/666666/? text=TV"),i.classList.add("series__container"),n.classList.add("series__name");findSerieInFavorites(e)&&(i.classList.add("selected"),n.classList.add("selected-name"))}addSeriesListeners()},handleSearchButtonClick=()=>{const e=document.querySelector(".js-searchInput").value;if(e)fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{originalSeries=e,printResults(e)});else{removeLastSearch();const e=document.createElement("p"),t=document.createTextNode("Escribe algo :)");resultsContainer.appendChild(e),e.appendChild(t)}};searchButton.addEventListener("click",handleSearchButtonClick);const printFavoriteSeriesOnStart=()=>{for(const e of favoriteSeries)printFavorites(e)};printFavoriteSeriesOnStart();